### NixOS Config

New machine setup

Build ISO: `nix build .#nixosConfigurations.iso.config.system.build.isoImage`

Installation guide: <https://nixos.org/manual/nixos/unstable/#sec-installation-manual>

1. Clone repo

```bash
git clone https://github.com/imcquee/nix-home.git
```

2. Replace ./hardware-configuration.nix with the one generated by `nixos-generate-config`
  
3. Rebuild host

```bash
sudo nixos-rebuild switch --flake /home/imcquee/nix-home/#<hostname>
```
  
4. On subsequent runs, just run:`rebuild <hostname>`

5. Get tailscale [key](https://login.tailscale.com/admin/settings/keys) and replace 'tskey-examplekeyhere' in tailscale.nix

### Non-Nixos setup

1. Install Nix

```bash
curl --proto '=https' --tlsv1.2 -sSf -L https://install.determinate.systems/nix | sh -s -- install
```

2. Setup Home-Manger and Git (if not already installed)

```bash
nix-shell -p git home-manager
```

3. Clone repo

```bash
git clone https://github.com/imcquee/nix-home.git
```

4. Setup Home-Manager

```bash
home-manager switch --flake /home/imcquee/nix-home#universal
```

5. Install tailscale

```bash
curl -fsSL https://tailscale.com/install.sh | sh
```

### Darwin setup

1. Install Nix

```bash
curl --proto '=https' --tlsv1.2 -sSf -L https://install.determinate.systems/nix | sh -s -- install
```

2. Setup Git (if not already installed)

```bash
nix-shell -p git
```

3. Clone repo

```bash
git clone https://github.com/imcquee/nix-home.git
```

4. Rebuild host

```bash
nix run nix-darwin -- switch --flake .#Isaacs-MacBook-Pro
```

5. On subsequent runs, just run:`darwin-rebuild switch --flake .#Isaacs-MacBook-Pro`

### Useful tips

#### Upgrading flake

1. nix flake update

#### Authenticating with GitHub

1. `gh auth login`
2. `gh auth setup-git`

### TODO

- [x] Make public
- [x] Migrate Neovim
- [x] Fix copy paste in neovim
- [x] Add DE option
- [x] Add Non-Nixos + WSL setup
- [x] Build custom installer
- [x] Migrate Darwin over
- [ ] Build custom bootstrap script for Non-Nixos environments
- [ ] Fix systemd services
